Libraries

```{r}

library(sf)
library(dplyr)
library(classInt)
library(tmap)

setwd('C:\\Users\\Taylor\\My Drive\\School\\01 Current Semester\\R\\06 Final Project')

```

Cleveland Data

```{r}

# load data

cle <- st_read('C:\\Users\\Taylor\\My Drive\\School\\01 Current Semester\\R\\06 Final Project\\Combined_Parcels_-_cle_Only\\Combined_Parcels_-_cle_Only.shp')

# filter data

cle <- dplyr::select(cle, c('certifie_3', 'total_acre', 'geometry'))

# calculate tax productivity

cle$tax_prod <- with(cle, certifie_3/total_acre) 

# remove NA's, then inf's and 0's

cle <- cle %>%
             filter(!is.na(tax_prod)) %>%
             filter(!is.infinite(tax_prod)) %>%
             filter(tax_prod != 0)

# (from classInt library) create classification breaks

cle.breaks <- classIntervals(cle$tax_prod, n = 5, style = 'fisher')

# add column to cle data set using classification breaks

cle <- cle %>% mutate(percent_class = cut(tax_prod, cle.breaks$brks, include.lowest = T))

```

Cleveland map

```{r}

cle.map <- tm_shape(cle) +
                          tm_fill(col = 'tax_prod',
                                  style = 'fisher',
                                  palette = 'Greens', 
                                  border.alpha = 0,
                                  title = '$/Acre') +
                          tm_layout(main.title = 'Tax Productivity per Acre ($)',
                                    main.title.size = 1,
                                    frame = F,
                                    legend.outside = T,
                                    legend.outside.position = 'left') +
                          tmap_options(check.and.fix = T)

```

Columbus Data

```{r}

# load data

cbus <- st_read('C:\\Users\\Taylor\\My Drive\\School\\01 Current Semester\\R\\06 Final Project\\Parcel_Boundaries\\Parcel_Boundaries.shp')

# filter out non cbus metro parcels

cbus <- cbus %>% filter (cbus$CVTTXDSCRP == 'CITY OF cbus')

# filter data

cbus <- dplyr::select(cbus, c('TOTCNTTXOD','ACRES','geometry'))

# calculate tax productivity

cbus$tax_prod <- with(cbus, TOTCNTTXOD/ACRES) 

# remove NA's, then inf's and 0's

cbus <- cbus %>%
             filter(!is.na(tax_prod)) %>%
             filter(!is.infinite(tax_prod)) %>%
             filter(tax_prod != 0)

# (from classInt library) create classification breaks

cbus.breaks <- classIntervals(cbus$tax_prod, n = 5, style = 'fisher')

# add column to cle data set using classification breaks

cbus <- cbus %>% mutate(percent_class = cut(tax_prod, cbus.breaks$brks, include.lowest = T))

```

Columbus Map

```{r}

cbus.map <- tm_shape(cbus) +
                          tm_fill(col = 'tax_prod',
                                  palette = 'Greens',
                                  style = 'fisher',
                                  border.alpha = 0,
                                  title = '$/Acre') +
                          tm_layout(main.title = 'Tax Productivity per Acre ($)',
                                    main.title.size = 1,
                                    frame = F,
                                    legend.outside = T,
                                    legend.outside.position = 'left') +
                          tmap_options(check.and.fix = T)

```

Cincinnati Data

```{r}

#load data

cin <- st_read('C:\\Users\\Taylor\\My Drive\\School\\01 Current Semester\\R\\06 Final Project\\cin_parcels\\cin_parcels.shp')

#filter data

####cin <- cin %>% filter (cin$CVTTXDSCRP == 'CITY OF cbus')

# filter data

cin <- dplyr::select(cin, c('ANNUAL_TAX','ACREDEED','geometry'))

# calculate tax productivity

cin$tax_prod <- with(cin, ANNUAL_TAX/ACREDEED) 

# remove NA's, then inf's and 0's

cin <- cin %>%
             filter(!is.na(tax_prod)) %>%
             filter(!is.infinite(tax_prod)) %>%
             filter(tax_prod != 0)

# (from classInt library) create classification breaks

cin.breaks <- classIntervals(cin$tax_prod, n = 5, style = 'fisher')

# add column to cle data set using classification breaks

cin <- cin %>% mutate(percent_class = cut(tax_prod, cin.breaks$brks, include.lowest = T))

```

Cincinnati Map

```{r}

cin.map <- tm_shape(cin) +
                          tm_fill(col = 'tax_prod',
                                  palette = 'Greens',
                                  style = 'fisher',
                                  border.alpha = 0,
                                  title = '$/Acre') +
                          tm_layout(main.title = 'Tax Productivity per Acre ($)',
                                    main.title.size = 1,
                                    frame = F,
                                    legend.outside = T,
                                    legend.outside.position = 'left') +
                          tmap_options(check.and.fix = T)

cin.map

```

Third plot comparing statistics

```{r}

#average parcel size

cle.parcel.sum <- rowSums(cle$certifie_3)

cle.average.size <- cle.parcel.sum/133045

#total tax income

```

Analysis

```{r}

tmap_arrange(cle.map, cbus.map, cin.map)

```
